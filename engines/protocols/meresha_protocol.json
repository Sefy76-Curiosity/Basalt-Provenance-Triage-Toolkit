{
  "protocol_name": "Maresha Zooarchaeology Protocol",
  "version": "2.0",
  "author": "Sefy Levy",
  "description": "Standards-accurate JSON implementation of a Maresha-style zooarchaeological recording system, including element classification, taphonomy, fragmentation, age estimation, and integrated final interpretation.",
  "icon": "ðŸ¦´",

  "requires_fields": [
    "Sample_ID",
    "Element",
    "Portion",
    "Side",
    "Taxon",
    "Fusion",
    "Epiphysis",
    "Burning",
    "CutMarks",
    "Gnawing",
    "Weathering",
    "Fragmentation"
  ],

  "stages": [

    {
      "id": "missing_data",
      "name": "Missing Data Screening",
      "type": "rule_stage",
      "rules_logic": "OR",

      "rules": [
        {
          "label": "MISSING_ELEMENT",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Element", "operator": "is_null" }
          ],
          "outputs": {
            "QC_Class": "INSUFFICIENT_DATA",
            "Flag_For_Review": "YES",
            "Review_Reason": "Missing skeletal element"
          }
        },
        {
          "label": "MISSING_TAXON",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Taxon", "operator": "is_null" }
          ],
          "outputs": {
            "QC_Class": "INSUFFICIENT_DATA",
            "Flag_For_Review": "YES",
            "Review_Reason": "Missing taxonomic identification"
          }
        }
      ]
    },

    {
      "id": "element_identification",
      "name": "Element Identification",
      "type": "rule_stage",
      "rules_logic": "OR",

      "rules": [
        {
          "label": "AXIAL",
          "conditions_logic": "OR",
          "conditions": [
            { "field": "Element", "operator": "==", "value": "vertebra" },
            { "field": "Element", "operator": "==", "value": "rib" },
            { "field": "Element", "operator": "==", "value": "sternum" }
          ],
          "outputs": { "Element_Class": "AXIAL" }
        },
        {
          "label": "APPENDICULAR",
          "conditions_logic": "OR",
          "conditions": [
            { "field": "Element", "operator": "==", "value": "femur" },
            { "field": "Element", "operator": "==", "value": "tibia" },
            { "field": "Element", "operator": "==", "value": "humerus" },
            { "field": "Element", "operator": "==", "value": "radius" }
          ],
          "outputs": { "Element_Class": "APPENDICULAR" }
        },
        {
          "label": "CRANIAL",
          "conditions_logic": "OR",
          "conditions": [
            { "field": "Element", "operator": "==", "value": "mandible" },
            { "field": "Element", "operator": "==", "value": "maxilla" },
            { "field": "Element", "operator": "==", "value": "cranium" }
          ],
          "outputs": { "Element_Class": "CRANIAL" }
        }
      ]
    },

    {
      "id": "taphonomy",
      "name": "Taphonomic Assessment",
      "type": "rule_stage",
      "rules_logic": "OR",

      "rules": [
        {
          "label": "BURNED",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Burning", "operator": ">=", "value": 2 }
          ],
          "outputs": { "Taphonomy_Class": "BURNED" }
        },
        {
          "label": "CUT_MARKS",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "CutMarks", "operator": "==", "value": 1 }
          ],
          "outputs": { "Taphonomy_Class": "BUTCHERY" }
        },
        {
          "label": "GNAWED",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Gnawing", "operator": "==", "value": 1 }
          ],
          "outputs": { "Taphonomy_Class": "CARNIVORE_MODIFIED" }
        },
        {
          "label": "WEATHERED",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Weathering", "operator": ">=", "value": 3 }
          ],
          "outputs": { "Taphonomy_Class": "WEATHERED" }
        }
      ]
    },

    {
      "id": "fragmentation",
      "name": "Fragmentation Assessment",
      "type": "rule_stage",
      "rules_logic": "OR",

      "rules": [
        {
          "label": "HIGH_FRAGMENTATION",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Fragmentation", "operator": ">=", "value": 3 }
          ],
          "outputs": { "Fragmentation_Class": "HIGH" }
        },
        {
          "label": "LOW_FRAGMENTATION",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Fragmentation", "operator": "<", "value": 3 }
          ],
          "outputs": { "Fragmentation_Class": "LOW" }
        }
      ]
    },

    {
      "id": "age_sex",
      "name": "Age & Fusion Assessment",
      "type": "rule_stage",
      "rules_logic": "OR",

      "rules": [
        {
          "label": "JUVENILE",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Fusion", "operator": "==", "value": "unfused" }
          ],
          "outputs": { "Age_Class": "JUVENILE" }
        },
        {
          "label": "ADULT",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Fusion", "operator": "==", "value": "fused" }
          ],
          "outputs": { "Age_Class": "ADULT" }
        }
      ]
    },

    {
      "id": "final_classification",
      "name": "Integrated Maresha-Style Interpretation",
      "type": "rule_stage",
      "rules_logic": "OR",

      "rules": [

        {
          "label": "BURNED_FRAGMENT",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Taphonomy_Class", "operator": "==", "value": "BURNED" },
            { "field": "Fragmentation_Class", "operator": "==", "value": "HIGH" }
          ],
          "outputs": { "Final_Class": "BURNED_FRAGMENT" }
        },

        {
          "label": "BUTCHERY_APPENDICULAR",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Taphonomy_Class", "operator": "==", "value": "BUTCHERY" },
            { "field": "Element_Class", "operator": "==", "value": "APPENDICULAR" }
          ],
          "outputs": { "Final_Class": "APPENDICULAR_BUTCHERY" }
        },

        {
          "label": "CARNIVORE_AXIAL",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Taphonomy_Class", "operator": "==", "value": "CARNIVORE_MODIFIED" },
            { "field": "Element_Class", "operator": "==", "value": "AXIAL" }
          ],
          "outputs": { "Final_Class": "AXIAL_CARNIVORE_MODIFIED" }
        },

        {
          "label": "WEATHERED_CRANIAL",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Taphonomy_Class", "operator": "==", "value": "WEATHERED" },
            { "field": "Element_Class", "operator": "==", "value": "CRANIAL" }
          ],
          "outputs": { "Final_Class": "CRANIAL_WEATHERED" }
        },

        {
          "label": "JUVENILE_ELEMENT",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Age_Class", "operator": "==", "value": "JUVENILE" }
          ],
          "outputs": { "Final_Class": "JUVENILE_SPECIMEN" }
        },

        {
          "label": "ADULT_ELEMENT",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Age_Class", "operator": "==", "value": "ADULT" }
          ],
          "outputs": { "Final_Class": "ADULT_SPECIMEN" }
        }
      ]
    },

    {
      "id": "review_stage",
      "name": "Review Flags",
      "type": "rule_stage",
      "rules_logic": "OR",

      "rules": [
        {
          "label": "REVIEW_IF_UNCLASSIFIED",
          "conditions_logic": "AND",
          "conditions": [
            { "field": "Final_Class", "operator": "is_null" }
          ],
          "outputs": {
            "Flag_For_Review": "YES",
            "Review_Reason": "No final classification"
          }
        }
      ]
    }
  ],

  "final_outputs": {
    "primary_classification_field": "Final_Class",
    "qc_field": "QC_Class",
    "flag_field": "Flag_For_Review"
  }
}
